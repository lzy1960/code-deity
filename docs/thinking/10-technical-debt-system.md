# 设计文档：技术债务 (Technical Debt) 系统

**版本:** 1.0
**日期:** 2025-09-16

## 1. 设计哲学：一颗昂贵的“后悔药”

在《代码神祇》这样一款以深度策略为核心的游戏中，玩家的每一个决策都应具有“分量感”。然而，过于严苛、不可逆的决策也会带来挫败感，惩罚玩家的探索精神。

“技术债务”系统的核心设计哲学，就是在这两者之间找到一个完美的平衡点。它为玩家提供了一颗昂贵的“后悔药”，允许玩家修正过去的战略失误，但要求他们为此付出合理的、符合主题的代价。

### 1.1. 设计比喻：重构乐高城堡

我们可以将这个系统比作重构一座用乐高积木搭建的城堡：

- **技能树**: 是玩家的**乐高零件库**。
- **学习技能**: 是将**砖块拼接到城堡上**的动作。

如果玩家在城堡底层使用了错误的砖块（学错了前置技能），导致无法实现最终的宏伟蓝图，“技术债务”系统允许他们“重构”这个地基。但这需要付出代价：
1.  **暂停施工**：所有依赖地基的上层建筑（后续技能）都必须先被拆除并暂时失效。
2.  **付出代价**：玩家需要花费额外的精力（CP 算力）来撬开那些已经拼好的砖块。在此期间，整体施工效率（全局 CP 产出）还会下降。
3.  **获得回报**：一旦代价付清，那些旧砖块（被冻结的 SP）就会被完整地归还到零件库中，玩家可以自由地用它们换取新的砖块，去实现最初的梦想。

---

## 2. 系统工作流程详解

以下是“技术债务”系统在游戏中的完整工作流程：

1.  **发起重构**:
    -   玩家在任意一个**已学习的**技能节点上，点击【申请重构】按钮。
    -   此操作仅在当前没有其他重构任务时可用。

2.  **进入“偿还”期**:
    -   **冻结技能**: 系统会立刻计算出所有依赖于被选技能的下游技能。这些技能（包括被选技能本身）将立即从技能树上**消失**，其提供的所有加成也**瞬间失效**。
    -   **冻结资源**: 学习这些技能所花费的奇点算力 (SP) 将被**全部冻结**。
    -   **计算成本**: 系统会根据被冻结的 SP 总量，通过公式 `CP 成本 = 10 ^ (冻结SP * 1.5 + 308)` 计算出一笔需要用 CP (算力) 来偿还的“技术债务”。
    -   **施加惩罚**: 在偿还期间，玩家的**总 CP 产出会有一个 10% 的全局性惩罚**。
    -   **UI 提示**: 一个“技术债务”面板会出现在屏幕顶端，清晰地展示重构目标、待返还的 SP、需偿还的 CP 成本以及当前的全局惩罚。

3.  **偿还或取消**:
    -   玩家可以选择继续游戏，努力积攒 CP 以达到偿还目标。
    -   玩家也可以随时点击面板上的【取消】按钮，放弃这次重构。取消后，所有被冻结的技能和 SP 将立刻恢复原状，全局惩罚消失。

4.  **完成重构**:
    -   当玩家的 CP 达到或超过所需成本时，面板上的【确认偿还】按钮会变为可用状态。
    -   点击后，系统会：
        1.  扣除相应的 CP。
        2.  将被冻结的 SP **全额返还**到玩家的 SP 池中。
        3.  移除全局 CP 产出惩罚。
        4.  移除“技术债务”面板。

---

## 3. 结论

“技术债务”系统不仅为玩家提供了纠错的途径，保证了游戏的长期可玩性，其本身也成为了一个新的策略维度——“何时偿还技术债务？”将成为玩家在第二纪元需要思考的又一个有趣问题。这套机制完美地融入了游戏的核心主题，并提升了整体的策略深度。
